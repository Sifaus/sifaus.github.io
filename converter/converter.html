<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<title>Converter</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta http-equiv="content-type" content="text/html; charset=utf-8">
		<meta http-equiv="cache-control" content="max-age=0" />
		<meta http-equiv="cache-control" content="no-cache" />
		<meta http-equiv="expires" content="0" />
		<meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
		<meta http-equiv="pragma" content="no-cache" />
		<script type="text/javascript">
			var textbox = '';
			var finished = '';
			var original = '';
			var array_type = 4;
			var rows = [];

			function convert_it(converter) {
				if (document.getElementById('double_quote').checked) { var quote = '"'; }
				else { var quote = "'"; }

				var separater = '\t';

				textbox = document.getElementById('textbox').value;

				if (finished == textbox) { textbox = original; }
				else { original = document.getElementById('textbox').value; }

				var commas = textbox.split(',').length - 1;
				var tabs = textbox.split('\t').length - 1;

				if (commas > tabs) { separater = /,\s*(?=(?:[^"]|"[^"]*")*$)/; }

				var lines = textbox.split(/\r?\n(?=(?:[^"]|"[^"]*")*$)/);

				rows = [];

				for (var i = 0; i < lines.length; i++) {
					rows[i] = lines[i].split(separater);

					for (var a = 0; a < rows[i].length; a++) {
						if ((rows[i][a].charAt(0) == '"' && rows[i][a].charAt(rows[i][a].length - 1) == '"') ||
							(rows[i][a].charAt(0) == "'" && rows[i][a].charAt(rows[i][a].length - 1) == "'")) {
							rows[i][a] = rows[i][a].substr(1);
							rows[i][a] = rows[i][a].slice(0, -1);
						}
					}
				}

				if (rows[rows.length - 1].length == 1 && rows[rows.length - 1][0] == "") { rows.pop(); }

				if (converter == 1) {
					textbox = "<table border='1'>";

					for (var x = 0; x < rows.length; x++) {
						textbox += "<tr>";

						for (var y = 0; y < rows[x].length; y++) {
							if (rows[x][y] || !document.getElementById('blank_fields').checked) {
								if ((x == 0 && document.getElementById('row_headers').checked) ||
									(y == 0 && document.getElementById('col_headers').checked)) {
									textbox += "<th>" + rows[x][y] + "</th>";
								}
								else {
									textbox += "<td>" + rows[x][y] + "</td>";
								}
							}
						}
						textbox += "</tr>\n";
					}
					textbox += "</table>";
				}
				else if (converter == 2) {
					array_type = 2;
					textbox = "";

					for (var x = 0; x < rows.length; x++) {
						for (var y = 0; y < rows[x].length; y++) {
							if (rows[x][y] || !document.getElementById('blank_fields').checked) {
								if (document.getElementById('numbers_to_string').checked || isNaN(rows[x][y]) || rows[x][y] == "") {
									textbox += quote + rows[x][y] + quote;
								}
								else { textbox += rows[x][y]; }

								if (x < rows.length - 1 || y < rows[x].length - 1) { textbox += ", "; }
							}
						}
						if (document.getElementById('newlines').checked)
							textbox += "\n";

					}

				}
				else if (converter == 3) {
					array_type = 3;

					if (document.getElementById('top').checked) {
						textbox = "[\n";

						for (var x = 1; x < rows.length; x++) {
							textbox += "{";
							for (var y = 0; y < rows[x].length; y++) {
								if (rows[x][y] || !document.getElementById('blank_fields').checked) {
									if (y > 0) { textbox += ", "; }
									if (document.getElementById('newlines').checked) {
										textbox += "\n\t";
									}
									if (document.getElementById('numbers_to_string').checked || isNaN(rows[x][y]) || rows[x][y] == "") {
										textbox += quote + rows[0][y] + quote + ": " + quote + rows[x][y] + quote;
									}
									else { textbox += quote + rows[0][y] + quote + ": " + rows[x][y]; }
								}
							}
							textbox += "}";
							if (x < rows.length - 1) { textbox += ", "; }
							if (document.getElementById('newlines').checked) { textbox += "\n"; }
						}

						textbox += "]";
					}
					else {
						textbox = "[\n";
						var more = 1;

						for (var y = 1; more > 0; y++) {
							more = 0;
							textbox += "{";

							for (var x = 0; x < rows.length; x++) {
								if (y < rows[x].length) {
									if (rows[x][y] || !document.getElementById('blank_fields').checked) {
										if (x > 0) { textbox += ", "; }
										if (x > 0 && document.getElementById('newlines').checked) { textbox += "\n"; }
										if (document.getElementById('numbers_to_string').checked || isNaN(rows[x][y]) || rows[x][y] == "") {
											textbox += quote + rows[x][0] + quote + ": " + quote + rows[x][y] + quote;
										}
										else { textbox += quote + rows[x][0] + quote + ": " + rows[x][y]; }
										if (y < rows[x].length - 1) { more = 1; }
									}
								}
							}

							textbox += "}";
							if (more == 1) { textbox += ", "; }
							if (document.getElementById('newlines').checked) { textbox += "\n"; }
						}

						textbox += "]";
					}
				}
				else if (converter == 4) {
					array_type = 4;
					textbox = "[\n";

					for (var x = 0; x < rows.length; x++) {
						textbox += "\t[";

						for (var y = 0; y < rows[x].length; y++) {
							if (rows[x][y] || !document.getElementById('blank_fields').checked) {
								if (y > 0) { textbox += ", "; }
								if (document.getElementById('numbers_to_string').checked || isNaN(rows[x][y]) || rows[x][y] == "") {
									textbox += quote + rows[x][y] + quote;
								}
								else { textbox += rows[x][y]; }
							}
						}

						textbox += "]";

						if (x < rows.length - 1) { textbox += ", "; }
						if (document.getElementById('newlines').checked) { textbox += "\n"; }
					}

					textbox += "]";
				}

				document.getElementById('textbox').value = textbox;
				finished = textbox;
			}
		</script>
		<style>
			textarea { width: 100%; } 
		</style>
	</head>
	<body>
		<textarea name="textbox" id="textbox" rows="36" autofocus="autofocus"></textarea>
		<div id="array_options" style="display:block">
			<br>
			Surround With:
			<input type="radio" name="quote" id="double_quote" checked onclick="convert_it(array_type)"><label for="double_quote"> " </label>
			<input type="radio" name="quote" id="single_quote" onclick="convert_it(array_type)"><label for="single_quote"> ' </label>
			<br>
			<input type="checkbox" id="newlines" value="1" checked onclick="convert_it(array_type)"><label for="newlines">Keep newlines</label>
			<br>
			<input type="checkbox" id="blank_fields" value="1" onclick="convert_it(array_type)"><label for="blank_fields">Remove blank fields</label>
			<br>
			<input type="checkbox" id="numbers_to_string" value="1" onclick="convert_it(array_type)"><label for="numbers_to_string">Convert numbers to strings</label>
			<br>
			<input type="checkbox" id="row_headers" value="1" checked onclick="convert_it(1)"><label for="row_headers">First top row contains headers</label>
			<br>
			<input type="checkbox" id="col_headers" value="1" onclick="convert_it(1)"><label for="col_headers">First left column contains headers</label>
			<br>
			<input type="radio" name="keys" id="top" checked onclick="convert_it(3)"><label for="top">Top Row</label>
			<input type="radio" name="keys" id="left" onclick="convert_it(3)"><label for="left">Left Column</label>
		</div>
		<input type="button" name="convert" value="Convert to Table" onclick="convert_it(1);">
		<input type="button" name="convert" value="Convert to Array" onclick="convert_it(2);">
		<input type="button" name="convert" value="Convert to Associative Array" onclick="convert_it(3);">
		<input type="button" name="convert" value="Convert to Multidimensional Array" onclick="convert_it(4);">
	</body>
</html>